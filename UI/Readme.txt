Its not pretty, But it works. 
Do tell me if there is something missing, or you want something changed.